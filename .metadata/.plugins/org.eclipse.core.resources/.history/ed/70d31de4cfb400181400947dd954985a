package movie.member;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import javax.naming.Context;
import javax.naming.InitialContext;
import javax.sql.DataSource;

public class MemberDBBean {
	private static MemberDBBean instance = new MemberDBBean();
	
	public static MemberDBBean getInstance() {
		return instance;
	}
	
	private MemberDBBean() {}
	
	private Connection getConnection() throws Exception {
	    Context initCtx = new InitialContext();
	    Context envCtx = (Context) initCtx.lookup("java:comp/env");
	    DataSource ds = (DataSource)envCtx.lookup("jdbc/miso");
	    return ds.getConnection();
	}
	
	public String insertMember(MemberDBBean member) throws Exception {
		Connection conn = null;
		PreparedStatement pstmt = null;
		String rs = "";
			        
		try{
			conn = getConnection();
			
			pstmt = conn.prepareStatement("insert into member values (?)");
			pstmt.setInt(1, member.getMem_id());
			pstmt.setInt(2, member.getMem_status());
			
		} catch(Exception e) {
			e.printStackTrace();
			rs = "error";
		} finally {
			if(pstmt != null)
				try {pstmt.close();} catch(SQLException ex) {}
			if(conn != null)
				try {conn.close();} catch(SQLException ex) {}
		}
		return rs;
	}
	
}
